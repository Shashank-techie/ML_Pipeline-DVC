schema: '2.0'
stages:
  preprocess:
    cmd: python src/data_preprocessing.py
    deps:
    - path: data/raw/raw.csv
      hash: md5
      md5: 448de498a9f801b2a2f00c733ae192f5
      size: 310056916
    - path: src/data_preprocessing.py
      hash: md5
      md5: 54eb036eccafcb360abfe7a103cdc605
      size: 3395
    params:
      params.yaml:
        data:
          raw_path: data/raw/raw.csv
          processed_path: data/processed/raw_processed.csv
          features:
          - cpu_request
          - mem_request
          - cpu_limit
          - mem_limit
          - runtime_minutes
          - controller_kind
          target: cpu_usage
        preprocessing:
          test_size: 0.2
          random_state: 42
          categorical_columns:
          - controller_kind
    outs:
    - path: data/processed/processed_data.pkl
      hash: md5
      md5: 41dec89dd1c056a1043d3a4f9e9b95a4
      size: 15906655
    - path: models/label_encoder.pkl
      hash: md5
      md5: d7d2db561f29d2326035862459663e00
      size: 485
    - path: models/scaler.pkl
      hash: md5
      md5: ce1ad19a371407607cc6d13d702d0762
      size: 1039
  train:
    cmd: python src/training.py
    deps:
    - path: data/processed/processed_data.pkl
      hash: md5
      md5: 41dec89dd1c056a1043d3a4f9e9b95a4
      size: 15906655
    - path: src/training.py
      hash: md5
      md5: 0f33d25181f45a6cbed951fc6b147fb3
      size: 4932
    params:
      params.yaml:
        data:
          features:
          - cpu_request
          - mem_request
          - cpu_limit
          - mem_limit
          - runtime_minutes
          - controller_kind
          processed_path: data/processed/raw_processed.csv
          raw_path: data/raw/raw.csv
          target: cpu_usage
        model:
          name: lightgbm
          lightgbm:
            colsample_bytree: 0.8
            learning_rate: 0.05
            max_depth: 8
            n_estimators: 100
            num_leaves: 31
            random_state: 42
            subsample: 0.8
          random_forest:
            max_depth: 15
            min_samples_leaf: 1
            min_samples_split: 2
            n_estimators: 100
            random_state: 42
          xgboost:
            colsample_bytree: 0.8
            learning_rate: 0.1
            max_depth: 6
            n_estimators: 100
            random_state: 42
            subsample: 0.8
    outs:
    - path: metrics/training/lightgbm_metrics.json
      hash: md5
      md5: 3e9741e827e728e844337275b5c3c1fa
      size: 474
    - path: models/lightgbm_model.pkl
      hash: md5
      md5: 5f6993b5144ce2b53b0fea9f3c52213c
      size: 313136
  evaluate:
    cmd: python src/evaluation.py
    deps:
    - path: models/lightgbm_model.pkl
      hash: md5
      md5: 5f6993b5144ce2b53b0fea9f3c52213c
      size: 313136
    - path: src/evaluation.py
      hash: md5
      md5: b8836e69e8be2def010ab49e9de83d6c
      size: 10419
    outs:
    - path: metrics/evaluation/lightgbm_evaluation.json
      hash: md5
      md5: 80e2422f30b6255d874db222201cd154
      size: 154
    - path: metrics/plots/lightgbm
      hash: md5
      md5: 5506c039da42dd715e67355d570dc297.dir
      size: 602887
      nfiles: 4
