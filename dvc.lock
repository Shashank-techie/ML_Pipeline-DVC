schema: '2.0'
stages:
  preprocess:
    cmd: python src/data_preprocessing.py
    deps:
    - path: data/raw/raw.csv
      hash: md5
      md5: 448de498a9f801b2a2f00c733ae192f5
      size: 310056916
      isexec: true
    - path: src/data_preprocessing.py
      hash: md5
      md5: f64811c8913608e677e24ff2b1ea2af5
      size: 3299
      isexec: true
    params:
      params.yaml:
        data:
          features:
          - cpu_request
          - mem_request
          - cpu_limit
          - mem_limit
          - runtime_minutes
          - controller_kind
          processed_path: data/processed/raw_processed.csv
          raw_path: data/raw/raw.csv
          target: cpu_usage
        preprocessing:
          categorical_columns:
          - controller_kind
          random_state: 42
          test_size: 0.2
    outs:
    - path: data/processed/processed_data.pkl
      hash: md5
      md5: b93a7dcbbaa31c90d60ed06f0d55565b
      size: 15906655
      isexec: true
    - path: models/label_encoder.pkl
      hash: md5
      md5: d7d2db561f29d2326035862459663e00
      size: 485
      isexec: true
    - path: models/scaler.pkl
      hash: md5
      md5: 5e6a5bec1cb38d2b84e28309c392d251
      size: 1039
      isexec: true
  train:
    cmd: python src/training.py
    deps:
    - path: data/processed/processed_data.pkl
      hash: md5
      md5: b93a7dcbbaa31c90d60ed06f0d55565b
      size: 15906655
      isexec: true
    - path: src/training.py
      hash: md5
      md5: e73fc33d2df1b496c337d6398c370b37
      size: 4793
      isexec: true
    params:
      params.yaml:
        data:
          features:
          - cpu_request
          - mem_request
          - cpu_limit
          - mem_limit
          - runtime_minutes
          - controller_kind
          processed_path: data/processed/raw_processed.csv
          raw_path: data/raw/raw.csv
          target: cpu_usage
        model:
          lightgbm:
            colsample_bytree: 0.8
            learning_rate: 0.05
            max_depth: 8
            n_estimators: 100
            num_leaves: 31
            random_state: 42
            subsample: 0.8
          name: lightgbm
          random_forest:
            max_depth: 15
            min_samples_leaf: 1
            min_samples_split: 2
            n_estimators: 100
            random_state: 42
          xgboost:
            colsample_bytree: 0.8
            learning_rate: 0.1
            max_depth: 6
            n_estimators: 100
            random_state: 42
            subsample: 0.8
    outs:
    - path: metrics/training/lightgbm_metrics.json
      hash: md5
      md5: c0c5715ae8ae144e56b52372cc5df6b2
      size: 457
      isexec: true
    - path: models/lightgbm_model.pkl
      hash: md5
      md5: 47934351f2520e1d007c72521e4145e1
      size: 313078
      isexec: true
  evaluate:
    cmd: python src/evaluation.py
    deps:
    - path: models/lightgbm_model.pkl
      hash: md5
      md5: 47934351f2520e1d007c72521e4145e1
      size: 313078
      isexec: true
    - path: src/evaluation.py
      hash: md5
      md5: f66898da5b84c0d9506e443a6cc38699
      size: 10148
      isexec: true
    outs:
    - path: metrics/evaluation/lightgbm_evaluation.json
      hash: md5
      md5: f76e41f5ae21d4c002f6287da6182c2e
      size: 150
      isexec: true
    - path: metrics/plots/lightgbm
      hash: md5
      md5: 973fe531ef825475f6f676feb1d542d2.dir
      size: 663013
      nfiles: 4
  save_comparison:
    cmd: python src/save_comparison.py
    deps:
    - path: metrics/evaluation/lightgbm_evaluation.json
      hash: md5
      md5: 80e2422f30b6255d874db222201cd154
      size: 154
    - path: metrics/evaluation/random_forest_evaluation.json
      hash: md5
      md5: c24a82fa96ba1a4c78ff96b197d06a6b
      size: 160
    - path: metrics/evaluation/xgboost_evaluation.json
      hash: md5
      md5: 3ed5c1fba9e77877c4ea5ac95e68b479
      size: 154
    - path: src/save_comparison.py
      hash: md5
      md5: fcf42d9d7182b91d14cc649f736aad62
      size: 2345
    outs:
    - path: metrics/comparison/final_model_comparison.csv
      hash: md5
      md5: dcd8222720559e5b33f67ef31a68bf9e
      size: 340
    - path: metrics/comparison/final_model_comparison.json
      hash: md5
      md5: d2ffee26a67ca2fba1dba6ed384bb2fa
      size: 1456
