<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ model_name|upper }} - Model Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .metric-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .nav-section { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .plot-container { margin-bottom: 2rem; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark nav-section">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-microchip"></i> CPU Usage Predictor
            </a>
            <div class="navbar-nav">
                <a class="nav-link" href="/">Dashboard</a>
                <a class="nav-link" href="/predict">Predict</a>
                <a class="nav-link active" href="#">Model Details</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Header -->
        <div class="row mb-4">
            <div class="col-12">
                <h1>
                    <i class="fas fa-robot"></i> 
                    {{ model_name|upper }} Model Details
                </h1>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/">Dashboard</a></li>
                        <li class="breadcrumb-item active">{{ model_name|upper }}</li>
                    </ol>
                </nav>
            </div>
        </div>

        <!-- Performance Metrics -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-primary text-white">
                        <h3><i class="fas fa-chart-line"></i> Performance Metrics</h3>
                    </div>
                    <div class="card-body">
                        {% if metrics and metrics.test_metrics %}
                        <div class="row">
                            <div class="col-md-3 mb-3">
                                <div class="card metric-card">
                                    <div class="card-body text-center">
                                        <h5>RÂ² Score</h5>
                                        <h2>{{ "%.4f"|format(metrics.test_metrics.r2) }}</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card metric-card">
                                    <div class="card-body text-center">
                                        <h5>MAE</h5>
                                        <h2>{{ "%.4f"|format(metrics.test_metrics.mae) }}</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card metric-card">
                                    <div class="card-body text-center">
                                        <h5>MSE</h5>
                                        <h2>{{ "%.4f"|format(metrics.test_metrics.mse) }}</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card metric-card">
                                    <div class="card-body text-center">
                                        <h5>RMSE</h5>
                                        <h2>{{ "%.4f"|format(metrics.test_metrics.rmse) }}</h2>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% else %}
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle"></i> No metrics available for this model.
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>

        <!-- Feature Importance -->
        {% if feature_importance %}
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-info text-white">
                        <h3><i class="fas fa-sitemap"></i> Feature Importance</h3>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Feature</th>
                                        <th>Importance</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for feature, importance in feature_importance.items() %}
                                    <tr>
                                        <td>{{ feature }}</td>
                                        <td>{{ "%.4f"|format(importance) }}</td>
                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}

        <!-- Model Plots -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h3><i class="fas fa-chart-bar"></i> Model Visualizations</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <!-- Actual vs Predicted -->
                            <div class="col-md-6 plot-container">
                                <h5>Actual vs Predicted</h5>
                                <img src="{{ plot_paths.actual_vs_predicted }}" 
                                     alt="Actual vs Predicted" 
                                     class="img-fluid rounded">
                            </div>

                            <!-- Residual Plot -->
                            <div class="col-md-6 plot-container">
                                <h5>Residual Plot</h5>
                                <img src="{{ plot_paths.residual_plot }}" 
                                     alt="Residual Plot" 
                                     class="img-fluid rounded">
                            </div>

                            <!-- Feature Importance Plot -->
                            <div class="col-md-6 plot-container">
                                <h5>Feature Importance</h5>
                                <img src="{{ plot_paths.feature_importance_plot }}" 
                                     alt="Feature Importance" 
                                     class="img-fluid rounded">
                            </div>

                            <!-- Distribution Comparison -->
                            <div class="col-md-6 plot-container">
                                <h5>Distribution Comparison</h5>
                                <img src="{{ plot_paths.distribution_comparison }}" 
                                     alt="Distribution Comparison" 
                                     class="img-fluid rounded">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-white mt-5 py-4">
        <div class="container text-center">
            <p>CPU Usage Predictor &copy; 2024</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>